"use strict";(globalThis.webpackChunkmy_website=globalThis.webpackChunkmy_website||[]).push([[3176],{5486(e,o,a){a.r(o),a.d(o,{assets:()=>c,contentTitle:()=>d,default:()=>u,frontMatter:()=>i,metadata:()=>n,toc:()=>t});const n=JSON.parse('{"id":"manual-do-devops/infra/seguranca-ssl/59","title":"Atualizando Certificado SSL do Ajuda","description":"Este documento explica o processo de renova\xe7\xe3o do certificado SSL para a inst\xe2ncia Bookstack hospedada em ajuda.digitalsys.com.br e como o sistema de renova\xe7\xe3o autom\xe1tica foi configurado.","source":"@site/docs/03-manual-do-devops/infra/seguranca-ssl/atualizando-certificado-ssl-do-ajuda.md","sourceDirName":"03-manual-do-devops/infra/seguranca-ssl","slug":"/manual-do-devops/infra/seguranca-ssl/59","permalink":"/docs-preview/docs/manual-do-devops/infra/seguranca-ssl/59","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/03-manual-do-devops/infra/seguranca-ssl/atualizando-certificado-ssl-do-ajuda.md","tags":[],"version":"current","frontMatter":{"id":"59","title":"Atualizando Certificado SSL do Ajuda","updated_at":"2026-01-30T19:53:08.000Z"},"sidebar":"tutorialSidebar","previous":{"title":"Resolu\xe7\xe3o: Erros de Autentica\xe7\xe3o do Vault (Secret ID)","permalink":"/docs-preview/docs/manual-do-devops/infra/seguranca-certificados/138"},"next":{"title":"Invent\xe1rio de Recursos e M\xe1quinas","permalink":"/docs-preview/docs/manual-do-devops/infra/sem-capitulo/171"}}');var s=a(4848),r=a(8453);const i={id:59,title:"Atualizando Certificado SSL do Ajuda",updated_at:new Date("2026-01-30T19:53:08.000Z")},d="Atualizando Certificado SSL do Ajuda",c={},t=[{value:"Informa\xe7\xf5es do Certificado",id:"informa\xe7\xf5es-do-certificado",level:2},{value:"Renova\xe7\xe3o Manual do Certificado",id:"renova\xe7\xe3o-manual-do-certificado",level:2},{value:"Sistema de Renova\xe7\xe3o Autom\xe1tica",id:"sistema-de-renova\xe7\xe3o-autom\xe1tica",level:2},{value:"1. Script Personalizado de Renova\xe7\xe3o",id:"1-script-personalizado-de-renova\xe7\xe3o",level:3},{value:"2. Configura\xe7\xe3o do Cronjob",id:"2-configura\xe7\xe3o-do-cronjob",level:3},{value:"3. Timer do Systemd",id:"3-timer-do-systemd",level:3},{value:"Verifica\xe7\xe3o do Status do Certificado",id:"verifica\xe7\xe3o-do-status-do-certificado",level:2},{value:"Verifica\xe7\xe3o dos Logs de Renova\xe7\xe3o",id:"verifica\xe7\xe3o-dos-logs-de-renova\xe7\xe3o",level:2},{value:"Solu\xe7\xe3o de Problemas",id:"solu\xe7\xe3o-de-problemas",level:2},{value:"Contato para Suporte",id:"contato-para-suporte",level:2}];function l(e){const o={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,r.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(o.header,{children:(0,s.jsx)(o.h1,{id:"atualizando-certificado-ssl-do-ajuda",children:"Atualizando Certificado SSL do Ajuda"})}),"\n",(0,s.jsx)(o.h1,{id:"renova\xe7\xe3o-de-certificado-ssl-para-bookstack",children:"Renova\xe7\xe3o de Certificado SSL para Bookstack"}),"\n",(0,s.jsxs)(o.p,{children:["Este documento explica o processo de renova\xe7\xe3o do certificado SSL para a inst\xe2ncia Bookstack hospedada em ",(0,s.jsx)(o.code,{children:"ajuda.digitalsys.com.br"})," e como o sistema de renova\xe7\xe3o autom\xe1tica foi configurado."]}),"\n",(0,s.jsx)(o.h2,{id:"informa\xe7\xf5es-do-certificado",children:"Informa\xe7\xf5es do Certificado"}),"\n",(0,s.jsxs)(o.ul,{children:["\n",(0,s.jsxs)(o.li,{children:[(0,s.jsx)(o.strong,{children:"Dom\xednio"}),": ajuda.digitalsys.com.br"]}),"\n",(0,s.jsxs)(o.li,{children:[(0,s.jsx)(o.strong,{children:"Tipo de Chave"}),": ECDSA"]}),"\n",(0,s.jsxs)(o.li,{children:[(0,s.jsx)(o.strong,{children:"Caminho do Certificado"}),": /etc/letsencrypt/live/ajuda.digitalsys.com.br/fullchain.pem"]}),"\n",(0,s.jsxs)(o.li,{children:[(0,s.jsx)(o.strong,{children:"Caminho da Chave Privada"}),": /etc/letsencrypt/live/ajuda.digitalsys.com.br/privkey.pem"]}),"\n",(0,s.jsxs)(o.li,{children:[(0,s.jsx)(o.strong,{children:"Data de Expira\xe7\xe3o"}),": 10 de agosto de 2025 (renovado em 12 de maio de 2025)"]}),"\n"]}),"\n",(0,s.jsx)(o.h2,{id:"renova\xe7\xe3o-manual-do-certificado",children:"Renova\xe7\xe3o Manual do Certificado"}),"\n",(0,s.jsx)(o.p,{children:"Se for necess\xe1rio renovar o certificado manualmente, voc\xea pode executar o seguinte comando:"}),"\n",(0,s.jsx)(o.pre,{children:(0,s.jsx)(o.code,{className:"language-bash",children:"certbot renew --force-renewal\n"})}),"\n",(0,s.jsx)(o.p,{children:"Este comando tentar\xe1 renovar todos os certificados gerenciados pelo Certbot que est\xe3o pr\xf3ximos da expira\xe7\xe3o."}),"\n",(0,s.jsx)(o.p,{children:"Para renovar um certificado espec\xedfico:"}),"\n",(0,s.jsx)(o.pre,{children:(0,s.jsx)(o.code,{className:"language-bash",children:"certbot renew --cert-name ajuda.digitalsys.com.br\n"})}),"\n",(0,s.jsx)(o.p,{children:"Ap\xf3s a renova\xe7\xe3o, o Apache ser\xe1 recarregado automaticamente para aplicar o novo certificado."}),"\n",(0,s.jsx)(o.h2,{id:"sistema-de-renova\xe7\xe3o-autom\xe1tica",children:"Sistema de Renova\xe7\xe3o Autom\xe1tica"}),"\n",(0,s.jsx)(o.p,{children:"Foram configurados dois mecanismos redundantes para garantir a renova\xe7\xe3o autom\xe1tica do certificado:"}),"\n",(0,s.jsx)(o.h3,{id:"1-script-personalizado-de-renova\xe7\xe3o",children:"1. Script Personalizado de Renova\xe7\xe3o"}),"\n",(0,s.jsxs)(o.p,{children:["Foi criado um script personalizado em ",(0,s.jsx)(o.code,{children:"/usr/local/bin/renew-ssl.sh"})," que:"]}),"\n",(0,s.jsxs)(o.ul,{children:["\n",(0,s.jsx)(o.li,{children:"Tenta renovar o certificado"}),"\n",(0,s.jsx)(o.li,{children:"Recarrega o Apache ap\xf3s a renova\xe7\xe3o bem-sucedida"}),"\n",(0,s.jsx)(o.li,{children:"Registra o resultado em um arquivo de log"}),"\n"]}),"\n",(0,s.jsxs)(o.p,{children:[(0,s.jsx)(o.strong,{children:"C\xf3digo do Script"}),":"]}),"\n",(0,s.jsx)(o.pre,{children:(0,s.jsx)(o.code,{className:"language-bash",children:'#!/bin/bash\n# SSL certificate renewal script\ncertbot renew --quiet\nif [ $? -eq 0 ]; then\n  systemctl reload apache2\n  echo "Certificate renewal completed successfully on $(date)" >> /var/log/ssl-renewal.log\nelse\n  echo "Certificate renewal failed on $(date)" >> /var/log/ssl-renewal.log\nfi\n'})}),"\n",(0,s.jsx)(o.h3,{id:"2-configura\xe7\xe3o-do-cronjob",children:"2. Configura\xe7\xe3o do Cronjob"}),"\n",(0,s.jsx)(o.p,{children:"Um cronjob foi configurado para executar o script de renova\xe7\xe3o diariamente \xe0s 2h da manh\xe3:"}),"\n",(0,s.jsx)(o.pre,{children:(0,s.jsx)(o.code,{children:"0 2 * * * /usr/local/bin/renew-ssl.sh\n"})}),"\n",(0,s.jsxs)(o.p,{children:[(0,s.jsx)(o.strong,{children:"Explica\xe7\xe3o do Cronjob"}),":"]}),"\n",(0,s.jsxs)(o.ul,{children:["\n",(0,s.jsxs)(o.li,{children:[(0,s.jsx)(o.code,{children:"0"})," - Minuto (0 = no in\xedcio da hora)"]}),"\n",(0,s.jsxs)(o.li,{children:[(0,s.jsx)(o.code,{children:"2"})," - Hora (2 = 2h da manh\xe3)"]}),"\n",(0,s.jsxs)(o.li,{children:[(0,s.jsx)(o.code,{children:"* * *"})," - Executar todos os dias, todos os meses, todos os dias da semana"]}),"\n",(0,s.jsxs)(o.li,{children:[(0,s.jsx)(o.code,{children:"/usr/local/bin/renew-ssl.sh"})," - Caminho para o script a ser executado"]}),"\n"]}),"\n",(0,s.jsx)(o.h3,{id:"3-timer-do-systemd",children:"3. Timer do Systemd"}),"\n",(0,s.jsx)(o.p,{children:"Al\xe9m do cronjob, o sistema tamb\xe9m utiliza o timer do systemd para o Certbot, que \xe9 executado duas vezes ao dia:"}),"\n",(0,s.jsx)(o.pre,{children:(0,s.jsx)(o.code,{children:"certbot.timer - Run certbot twice daily\n"})}),"\n",(0,s.jsx)(o.p,{children:"Este timer \xe9 instalado automaticamente pelo pacote Certbot e fornece uma camada adicional de redund\xe2ncia."}),"\n",(0,s.jsx)(o.h2,{id:"verifica\xe7\xe3o-do-status-do-certificado",children:"Verifica\xe7\xe3o do Status do Certificado"}),"\n",(0,s.jsx)(o.p,{children:"Para verificar o status atual do certificado:"}),"\n",(0,s.jsx)(o.pre,{children:(0,s.jsx)(o.code,{className:"language-bash",children:"certbot certificates\n"})}),"\n",(0,s.jsx)(o.p,{children:"Este comando mostrar\xe1 todos os certificados gerenciados pelo Certbot, incluindo suas datas de expira\xe7\xe3o."}),"\n",(0,s.jsx)(o.h2,{id:"verifica\xe7\xe3o-dos-logs-de-renova\xe7\xe3o",children:"Verifica\xe7\xe3o dos Logs de Renova\xe7\xe3o"}),"\n",(0,s.jsx)(o.p,{children:"Os logs de renova\xe7\xe3o do certificado podem ser encontrados em:"}),"\n",(0,s.jsxs)(o.ol,{children:["\n",(0,s.jsx)(o.li,{children:"Log do Certbot:"}),"\n"]}),"\n",(0,s.jsx)(o.pre,{children:(0,s.jsx)(o.code,{className:"language-bash",children:"cat /var/log/letsencrypt/letsencrypt.log\n"})}),"\n",(0,s.jsxs)(o.ol,{start:"2",children:["\n",(0,s.jsx)(o.li,{children:"Log do script personalizado:"}),"\n"]}),"\n",(0,s.jsx)(o.pre,{children:(0,s.jsx)(o.code,{className:"language-bash",children:"cat /var/log/ssl-renewal.log\n"})}),"\n",(0,s.jsx)(o.h2,{id:"solu\xe7\xe3o-de-problemas",children:"Solu\xe7\xe3o de Problemas"}),"\n",(0,s.jsx)(o.p,{children:"Se o certificado n\xe3o for renovado automaticamente:"}),"\n",(0,s.jsxs)(o.ol,{children:["\n",(0,s.jsx)(o.li,{children:"Verifique se o script de renova\xe7\xe3o tem permiss\xf5es de execu\xe7\xe3o:"}),"\n"]}),"\n",(0,s.jsx)(o.pre,{children:(0,s.jsx)(o.code,{className:"language-bash",children:"ls -la /usr/local/bin/renew-ssl.sh\n"})}),"\n",(0,s.jsxs)(o.ol,{start:"2",children:["\n",(0,s.jsx)(o.li,{children:"Verifique se o cronjob est\xe1 configurado corretamente:"}),"\n"]}),"\n",(0,s.jsx)(o.pre,{children:(0,s.jsx)(o.code,{className:"language-bash",children:"crontab -l\n"})}),"\n",(0,s.jsxs)(o.ol,{start:"3",children:["\n",(0,s.jsx)(o.li,{children:"Verifique o status do timer do systemd:"}),"\n"]}),"\n",(0,s.jsx)(o.pre,{children:(0,s.jsx)(o.code,{className:"language-bash",children:"systemctl status certbot.timer\n"})}),"\n",(0,s.jsxs)(o.ol,{start:"4",children:["\n",(0,s.jsx)(o.li,{children:"Tente executar o script manualmente para identificar poss\xedveis erros:"}),"\n"]}),"\n",(0,s.jsx)(o.pre,{children:(0,s.jsx)(o.code,{className:"language-bash",children:"/usr/local/bin/renew-ssl.sh\n"})}),"\n",(0,s.jsxs)(o.ol,{start:"5",children:["\n",(0,s.jsx)(o.li,{children:"Verifique os logs para identificar erros espec\xedficos."}),"\n"]}),"\n",(0,s.jsx)(o.h2,{id:"contato-para-suporte",children:"Contato para Suporte"}),"\n",(0,s.jsx)(o.p,{children:"Em caso de problemas com a renova\xe7\xe3o do certificado, entre em contato com a equipe de infraestrutura atrav\xe9s do canal #infra no Slack."})]})}function u(e={}){const{wrapper:o}={...(0,r.R)(),...e.components};return o?(0,s.jsx)(o,{...e,children:(0,s.jsx)(l,{...e})}):l(e)}},8453(e,o,a){a.d(o,{R:()=>i,x:()=>d});var n=a(6540);const s={},r=n.createContext(s);function i(e){const o=n.useContext(r);return n.useMemo(function(){return"function"==typeof e?e(o):{...o,...e}},[o,e])}function d(e){let o;return o=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:i(e.components),n.createElement(r.Provider,{value:o},e.children)}}}]);
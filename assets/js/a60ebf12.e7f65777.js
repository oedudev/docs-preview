"use strict";(globalThis.webpackChunkmy_website=globalThis.webpackChunkmy_website||[]).push([[642],{8356(e,s,n){n.r(s),n.d(s,{assets:()=>d,contentTitle:()=>t,default:()=>u,frontMatter:()=>a,metadata:()=>i,toc:()=>l});const i=JSON.parse('{"id":"manual-do-devops/agentes-ia/arquitetura","title":"\ud83e\udd16 Arquitetura de Agentes de IA no Kubernetes","description":"Este documento descreve como os agentes (Cl\xf3vis, Roberval, Clementina) s\xe3o implantados e gerenciados no cluster Kubernetes da DigitalSys.","source":"@site/docs/03-manual-do-devops/agentes-ia/arquitetura.md","sourceDirName":"03-manual-do-devops/agentes-ia","slug":"/manual-do-devops/agentes-ia/arquitetura","permalink":"/docs-preview/docs/manual-do-devops/agentes-ia/arquitetura","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/03-manual-do-devops/agentes-ia/arquitetura.md","tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"Congratulations!","permalink":"/docs-preview/docs/tutorial-basics/congratulations"},"next":{"title":"\ud83d\udd10 Gest\xe3o de Segredos: Vault & External Secrets","permalink":"/docs-preview/docs/manual-do-devops/agentes-ia/seguranca-vault"}}');var r=n(4848),o=n(8453);const a={},t="\ud83e\udd16 Arquitetura de Agentes de IA no Kubernetes",d={},l=[{value:"Vis\xe3o Geral",id:"vis\xe3o-geral",level:2},{value:"Componentes Chave",id:"componentes-chave",level:3},{value:"Estrutura do Reposit\xf3rio (<code>agents</code>)",id:"estrutura-do-reposit\xf3rio-agents",level:2},{value:"Ciclo de Vida",id:"ciclo-de-vida",level:2}];function c(e){const s={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,o.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(s.header,{children:(0,r.jsx)(s.h1,{id:"-arquitetura-de-agentes-de-ia-no-kubernetes",children:"\ud83e\udd16 Arquitetura de Agentes de IA no Kubernetes"})}),"\n",(0,r.jsx)(s.p,{children:"Este documento descreve como os agentes (Cl\xf3vis, Roberval, Clementina) s\xe3o implantados e gerenciados no cluster Kubernetes da DigitalSys."}),"\n",(0,r.jsx)(s.h2,{id:"vis\xe3o-geral",children:"Vis\xe3o Geral"}),"\n",(0,r.jsxs)(s.p,{children:["Os agentes n\xe3o s\xe3o mais Droplets isolados. Eles s\xe3o ",(0,r.jsx)(s.strong,{children:"Deployments Kubernetes"})," stateless (no c\xf3digo) mas stateful na persist\xeancia, rodando em um pool de n\xf3s dedicados (",(0,r.jsx)(s.code,{children:"bots"}),")."]}),"\n",(0,r.jsx)(s.h3,{id:"componentes-chave",children:"Componentes Chave"}),"\n",(0,r.jsxs)(s.ol,{children:["\n",(0,r.jsxs)(s.li,{children:["\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.strong,{children:"Imagem Base Unificada:"})}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:["Todos os agentes usam a mesma imagem Docker: ",(0,r.jsx)(s.code,{children:"registry.digitalocean.com/digitalsys/openclaw-agent:latest"}),"."]}),"\n",(0,r.jsxs)(s.li,{children:["Esta imagem \xe9 baseada em ",(0,r.jsx)(s.code,{children:"node:22-bookworm"})," e cont\xe9m:","\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"openclaw"})," (Core)"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"@google/gemini-cli"})," (LLM)"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"gh"})," (GitHub CLI)"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"ffmpeg"}),", ",(0,r.jsx)(s.code,{children:"python3"}),", ",(0,r.jsx)(s.code,{children:"jq"}),", ",(0,r.jsx)(s.code,{children:"curl"})]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Build:"})," O build \xe9 autom\xe1tico via GitHub Actions no reposit\xf3rio ",(0,r.jsx)(s.code,{children:"agents"})," sempre que a pasta ",(0,r.jsx)(s.code,{children:"base/"})," \xe9 alterada."]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(s.li,{children:["\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.strong,{children:"Persist\xeancia (PVC):"})}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:["Cada agente tem seu pr\xf3prio ",(0,r.jsx)(s.strong,{children:"PersistentVolumeClaim (PVC)"})," de 10Gi a 25Gi (",(0,r.jsx)(s.code,{children:"do-block-storage"}),")."]}),"\n",(0,r.jsxs)(s.li,{children:["Montado em ",(0,r.jsx)(s.code,{children:"/root/.openclaw"}),"."]}),"\n",(0,r.jsxs)(s.li,{children:["Garante que mem\xf3rias (",(0,r.jsx)(s.code,{children:"MEMORY.md"}),"), sess\xf5es e configura\xe7\xf5es persistam entre restarts."]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(s.li,{children:["\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.strong,{children:"Configura\xe7\xe3o e Segredos:"})}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsx)(s.li,{children:"Nenhuma credencial fica hardcoded no Git."}),"\n",(0,r.jsxs)(s.li,{children:["Todas as vari\xe1veis sens\xedveis (",(0,r.jsx)(s.code,{children:"GITHUB_TOKEN"}),", ",(0,r.jsx)(s.code,{children:"LINEAR_API_KEY"}),", Tokens do Gateway) v\xeam do ",(0,r.jsx)(s.strong,{children:"HashiCorp Vault"}),"."]}),"\n",(0,r.jsxs)(s.li,{children:["O ",(0,r.jsx)(s.strong,{children:"External Secrets Operator (ESO)"})," sincroniza esses segredos para Secrets nativos do K8s (",(0,r.jsx)(s.code,{children:"&lt;agente>-env"}),"), que s\xe3o injetados no Pod via ",(0,r.jsx)(s.code,{children:"envFrom"}),"."]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(s.h2,{id:"estrutura-do-reposit\xf3rio-agents",children:["Estrutura do Reposit\xf3rio (",(0,r.jsx)(s.code,{children:"agents"}),")"]}),"\n",(0,r.jsxs)(s.p,{children:["O reposit\xf3rio ",(0,r.jsx)(s.code,{children:"digitalsys-tecnologia/agents"})," \xe9 a fonte da verdade."]}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{children:"agents/\n\u251c\u2500\u2500 base/                  # Dockerfile \xfanico para todos\n\u251c\u2500\u2500 clovis/\n\u2502   \u2514\u2500\u2500 k8s/               # Manifestos (Deployment, PVC, Secrets)\n\u251c\u2500\u2500 roberval/\n\u2502   \u2514\u2500\u2500 k8s/\n\u2514\u2500\u2500 clementina/\n    \u2514\u2500\u2500 k8s/\n"})}),"\n",(0,r.jsx)(s.h2,{id:"ciclo-de-vida",children:"Ciclo de Vida"}),"\n",(0,r.jsxs)(s.ol,{children:["\n",(0,r.jsxs)(s.li,{children:["\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.strong,{children:"Atualiza\xe7\xe3o de C\xf3digo/Ferramentas:"})}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:["Push no ",(0,r.jsx)(s.code,{children:"agents/base/Dockerfile"})," -> GitHub Actions builda nova imagem -> ",(0,r.jsx)(s.code,{children:"registry.digitalocean.com/...:latest"}),"."]}),"\n",(0,r.jsxs)(s.li,{children:["Para aplicar: ",(0,r.jsx)(s.code,{children:"kubectl rollout restart deployment/&lt;agente> -n bots"}),"."]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(s.li,{children:["\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.strong,{children:"Atualiza\xe7\xe3o de Configura\xe7\xe3o:"})}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:["Alterar ",(0,r.jsx)(s.code,{children:".yaml"})," no repo ",(0,r.jsx)(s.code,{children:"agents"})," -> ",(0,r.jsx)(s.code,{children:"kubectl apply -f agents/&lt;agente>/k8s/"}),"."]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(s.li,{children:["\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.strong,{children:"Atualiza\xe7\xe3o de Segredos:"})}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:["Editar no Vault (",(0,r.jsx)(s.code,{children:"kv/agents/&lt;agente>"}),") -> ESO sincroniza em 1 min -> Restart do Pod (se necess\xe1rio para ler nova ENV)."]}),"\n"]}),"\n"]}),"\n"]})]})}function u(e={}){const{wrapper:s}={...(0,o.R)(),...e.components};return s?(0,r.jsx)(s,{...e,children:(0,r.jsx)(c,{...e})}):c(e)}},8453(e,s,n){n.d(s,{R:()=>a,x:()=>t});var i=n(6540);const r={},o=i.createContext(r);function a(e){const s=i.useContext(o);return i.useMemo(function(){return"function"==typeof e?e(s):{...s,...e}},[s,e])}function t(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:a(e.components),i.createElement(o.Provider,{value:s},e.children)}}}]);
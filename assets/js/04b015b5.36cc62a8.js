"use strict";(globalThis.webpackChunkmy_website=globalThis.webpackChunkmy_website||[]).push([[6044],{4317(e,o,n){n.r(o),n.d(o,{assets:()=>t,contentTitle:()=>d,default:()=>p,frontMatter:()=>i,metadata:()=>r,toc:()=>c});const r=JSON.parse('{"id":"manual-do-devops/infra/sonarcloud/27","title":"Configura\xe7\xe3o/Cobertura de C\xf3digo com SonarCloud","description":"Este guia tem como objetivo ajudar na configura\xe7\xe3o do SonarCloud em projetos multi-repo e monorepo, integrando-os com o GitHub Actions para rodar testes, gerar relat\xf3rios e envi\xe1-los ao SonarCloud. Siga os passos abaixo para configurar corretamente em seu projeto.","source":"@site/docs/03-manual-do-devops/infra/sonarcloud/configuracaocobertura-de-codigo-com-sonarcloud.md","sourceDirName":"03-manual-do-devops/infra/sonarcloud","slug":"/manual-do-devops/infra/sonarcloud/27","permalink":"/docs-preview/docs/manual-do-devops/infra/sonarcloud/27","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/03-manual-do-devops/infra/sonarcloud/configuracaocobertura-de-codigo-com-sonarcloud.md","tags":[],"version":"current","frontMatter":{"id":"27","title":"Configura\xe7\xe3o/Cobertura de C\xf3digo com SonarCloud","updated_at":"2026-01-30T19:53:05.000Z"},"sidebar":"tutorialSidebar","previous":{"title":"Resolu\xe7\xe3o: Erros de Autentica\xe7\xe3o do Vault (Secret ID)","permalink":"/docs-preview/docs/manual-do-devops/infra/sem-capitulo/138"},"next":{"title":"CI/CD: Falha em depend\xeancias Python (Pillow/Pytest)","permalink":"/docs-preview/docs/manual-do-devops/troubleshooting/cicd-git/168"}}');var s=n(4848),a=n(8453);const i={id:27,title:"Configura\xe7\xe3o/Cobertura de C\xf3digo com SonarCloud",updated_at:new Date("2026-01-30T19:53:05.000Z")},d="Configura\xe7\xe3o/Cobertura de C\xf3digo com SonarCloud",t={},c=[{value:"<strong>1. Criando um Projeto no SonarCloud</strong>",id:"1-criando-um-projeto-no-sonarcloud",level:4},{value:"<strong>2. Adicionando Token do SonarCloud ao GitHub</strong>",id:"2-adicionando-token-do-sonarcloud-ao-github",level:4},{value:"<strong>3. Configurando o SonarCloud no Projeto</strong>",id:"3-configurando-o-sonarcloud-no-projeto",level:4},{value:"<strong>4. Configurando Workflow do GitHub Actions</strong>",id:"4-configurando-workflow-do-github-actions",level:4}];function l(e){const o={a:"a",code:"code",h1:"h1",h4:"h4",header:"header",img:"img",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,a.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(o.header,{children:(0,s.jsx)(o.h1,{id:"configura\xe7\xe3ocobertura-de-c\xf3digo-com-sonarcloud",children:"Configura\xe7\xe3o/Cobertura de C\xf3digo com SonarCloud"})}),"\n",(0,s.jsx)(o.p,{children:"Este guia tem como objetivo ajudar na configura\xe7\xe3o do SonarCloud em projetos multi-repo e monorepo, integrando-os com o GitHub Actions para rodar testes, gerar relat\xf3rios e envi\xe1-los ao SonarCloud. Siga os passos abaixo para configurar corretamente em seu projeto."}),"\n",(0,s.jsx)(o.h4,{id:"1-criando-um-projeto-no-sonarcloud",children:(0,s.jsx)(o.strong,{children:"1. Criando um Projeto no SonarCloud"})}),"\n",(0,s.jsxs)(o.ul,{children:["\n",(0,s.jsxs)(o.li,{children:["Acesse o ",(0,s.jsx)(o.a,{href:"https://sonarcloud.io",children:"SonarCloud"})," e fa\xe7a login pela ",(0,s.jsx)(o.strong,{children:"sua conta do GitHub"})," que est\xe1 na organiza\xe7\xe3o da DigitalSys"]}),"\n",(0,s.jsxs)(o.li,{children:["Clique em ",(0,s.jsx)(o.strong,{children:"\u201c+\u201d"})," no menu superior e selecione ",(0,s.jsx)(o.strong,{children:"\u201cAnalyze new project\u201d"})]}),"\n"]}),"\n",(0,s.jsx)(o.p,{children:(0,s.jsx)(o.img,{src:"http://plane.digitalsys.com.br/uploads/d548ef5a-76b8-450b-b1c2-c98209a0d886/b128e97b2c8b415e864384c504aacde2-image.png",alt:""})}),"\n",(0,s.jsxs)(o.ul,{children:["\n",(0,s.jsx)(o.li,{children:"Certifique que em \u201corganization\u201d esteja selecionada a organiza\xe7\xe3o da DigitalSys e escolha o reposit\xf3rio que deseja analisar"}),"\n",(0,s.jsxs)(o.li,{children:["Se estiver configurando para um projeto monorepo, selecione a op\xe7\xe3o ",(0,s.jsxs)(o.strong,{children:['"',(0,s.jsx)(o.strong,{children:"Setup a <u>monorepo</u>"}),'"']})," e escolha o reposit\xf3rio do seu projeto"]}),"\n"]}),"\n",(0,s.jsx)(o.p,{children:(0,s.jsx)(o.img,{src:"http://plane.digitalsys.com.br/uploads/d548ef5a-76b8-450b-b1c2-c98209a0d886/2e413270ddaf4ca9b7c941bf03159a6a-image.png",alt:""})}),"\n",(0,s.jsxs)(o.ul,{children:["\n",(0,s.jsxs)(o.li,{children:["Ap\xf3s selecionar seu projeto, clique em ",(0,s.jsx)(o.strong,{children:"\u201cSet Up\u201d"})]}),"\n",(0,s.jsx)(o.li,{children:"Na p\xe1gina seguinte, escolha o crit\xe9rio para o que ser\xe1 considerado novo c\xf3digo para as pr\xf3ximas an\xe1lises"}),"\n",(0,s.jsxs)(o.li,{children:["Selecione ",(0,s.jsx)(o.strong,{children:"\u201cPrevious version\u201d"})," para que cada nova vers\xe3o do c\xf3digo no GitHub seja analisada"]}),"\n",(0,s.jsxs)(o.li,{children:["Por fim, crie seu projeto clicando em ",(0,s.jsx)(o.strong,{children:"\u201cCreate Project\u201d"})]}),"\n"]}),"\n",(0,s.jsx)(o.p,{children:(0,s.jsx)(o.img,{src:"http://plane.digitalsys.com.br/uploads/d548ef5a-76b8-450b-b1c2-c98209a0d886/ac3a49599974434093b4c4e2a0b535b7-image.png",alt:""})}),"\n",(0,s.jsx)(o.h4,{id:"2-adicionando-token-do-sonarcloud-ao-github",children:(0,s.jsx)(o.strong,{children:"2. Adicionando Token do SonarCloud ao GitHub"})}),"\n",(0,s.jsxs)(o.ul,{children:["\n",(0,s.jsxs)(o.li,{children:["Ap\xf3s Criar o projeto, selecione ",(0,s.jsx)(o.strong,{children:"\u201cWith GitHub Actions\u201d"})," para o m\xe9todo de an\xe1lise"]}),"\n"]}),"\n",(0,s.jsx)(o.p,{children:(0,s.jsx)(o.img,{src:"http://plane.digitalsys.com.br/uploads/d548ef5a-76b8-450b-b1c2-c98209a0d886/8af9fde02c0d4c54a7fba71a8d599853-image.png",alt:""})}),"\n",(0,s.jsxs)(o.ul,{children:["\n",(0,s.jsx)(o.li,{children:"Na p\xe1gina seguinte copie o Sonar Token gerado"}),"\n"]}),"\n",(0,s.jsx)(o.p,{children:(0,s.jsx)(o.img,{src:"http://plane.digitalsys.com.br/uploads/d548ef5a-76b8-450b-b1c2-c98209a0d886/0cb9eab7c7bb47bb99713c4d51f0f471-image.png",alt:""})}),"\n",(0,s.jsxs)(o.ul,{children:["\n",(0,s.jsxs)(o.li,{children:["No reposit\xf3rio do GitHub, v\xe1 para ",(0,s.jsx)(o.strong,{children:"Settings > Secrets and variables > Actions"})]}),"\n"]}),"\n",(0,s.jsx)(o.p,{children:(0,s.jsx)(o.img,{src:"http://plane.digitalsys.com.br/uploads/d548ef5a-76b8-450b-b1c2-c98209a0d886/041f4bee2c7c42e091914861600c3391-image.png",alt:""})}),"\n",(0,s.jsxs)(o.ul,{children:["\n",(0,s.jsxs)(o.li,{children:["No nome do Secret escreva ",(0,s.jsx)(o.code,{children:"SONAR_TOKEN"})," e em secret cole o Token gerado pelo SonarCloud"]}),"\n",(0,s.jsxs)(o.li,{children:["Por fim, Clique em ",(0,s.jsx)(o.strong,{children:"\u201cAdd secret\u201d"})," para criar o Secret"]}),"\n"]}),"\n",(0,s.jsx)(o.p,{children:(0,s.jsx)(o.img,{src:"http://plane.digitalsys.com.br/uploads/d548ef5a-76b8-450b-b1c2-c98209a0d886/c643536e816f4a6d8d0b44e39ab49052-image.png",alt:""})}),"\n",(0,s.jsx)(o.h4,{id:"3-configurando-o-sonarcloud-no-projeto",children:(0,s.jsx)(o.strong,{children:"3. Configurando o SonarCloud no Projeto"})}),"\n",(0,s.jsxs)(o.ul,{children:["\n",(0,s.jsxs)(o.li,{children:["Voltando para a p\xe1gina do SonarCloud podemos acessar as informa\xe7\xf5es do projeto no menu lateral clicando no bot\xe3o ",(0,s.jsx)(o.strong,{children:"\u201cInformation\u201d"})]}),"\n",(0,s.jsx)(o.li,{children:"Essa p\xe1gina contem as chaves de projeto e de organiza\xe7\xe3o"}),"\n"]}),"\n",(0,s.jsx)(o.p,{children:(0,s.jsx)(o.img,{src:"http://plane.digitalsys.com.br/uploads/d548ef5a-76b8-450b-b1c2-c98209a0d886/08c6e513e5fe4c9491b58d1f6b0f3797-image.png",alt:""})}),"\n",(0,s.jsxs)(o.ul,{children:["\n",(0,s.jsxs)(o.li,{children:["Essas chaves devem estar presente em um arquivo ",(0,s.jsx)(o.code,{children:"sonar-project.properties"})," na ",(0,s.jsx)(o.strong,{children:"raiz"})," do seu projeto, da seguinte forma"]}),"\n"]}),"\n",(0,s.jsx)(o.pre,{children:(0,s.jsx)(o.code,{children:"sonar.projectKey=DigitalsysTecnologia_exemplo\nsonar.organization=digitalsys\n"})}),"\n",(0,s.jsxs)(o.ul,{children:["\n",(0,s.jsxs)(o.li,{children:["Caso o projeto analisado seja monorepo, ",(0,s.jsx)(o.strong,{children:"al\xe9m do arquivo de propriedades da raiz,"})," cada m\xf3dulo deve conter seu pr\xf3prio ",(0,s.jsx)(o.code,{children:"sonar-project.properties"}),", alterando entre eles o sonar.projectKey para o informado no seu reposit\xf3rio pr\xf3prio do SonarCloud"]}),"\n",(0,s.jsx)(o.li,{children:"No arquivo de propriedades do SonarCloud tamb\xe9m podem ser definidas algumas configura\xe7\xf5es, as mais utilizadas s\xe3o:"}),"\n"]}),"\n",(0,s.jsxs)(o.p,{children:['<colgroup><col style="width: 262px;"></col><col style="width: 356px;"></col><col style="width: 417px;"></col></colgroup>   ',(0,s.jsx)(o.strong,{children:"COMANDO"})]}),"\n",(0,s.jsx)(o.p,{children:(0,s.jsx)(o.strong,{children:"DESCRI\xc7\xc3O"})}),"\n",(0,s.jsx)(o.p,{children:(0,s.jsx)(o.strong,{children:"EXEMPLO"})}),"\n",(0,s.jsx)(o.p,{children:(0,s.jsx)(o.code,{children:"sonar.projectKey"})}),"\n",(0,s.jsx)(o.p,{children:"Identificador \xfanico do projeto no SonarCloud"}),"\n",(0,s.jsx)(o.p,{children:(0,s.jsx)(o.code,{children:"sonar.projectKey=my_project_key"})}),"\n",(0,s.jsx)(o.p,{children:(0,s.jsx)(o.code,{children:"sonar.organization"})}),"\n",(0,s.jsx)(o.p,{children:"Nome da organiza\xe7\xe3o no SonarCloud"}),"\n",(0,s.jsx)(o.p,{children:(0,s.jsx)(o.code,{children:"sonar.organization=my_organization"})}),"\n",(0,s.jsx)(o.p,{children:(0,s.jsx)(o.code,{children:"sonar.sources"})}),"\n",(0,s.jsx)(o.p,{children:"Diret\xf3rio(s) onde o c\xf3digo-fonte est\xe1 localizado. Pode ser m\xfaltiplo, separado por v\xedrgulas"}),"\n",(0,s.jsx)(o.p,{children:(0,s.jsx)(o.code,{children:"sonar.sources=src"})}),"\n",(0,s.jsx)(o.p,{children:(0,s.jsx)(o.code,{children:"sonar.tests"})}),"\n",(0,s.jsx)(o.p,{children:"Diret\xf3rio(s) onde os testes est\xe3o localizados. Pode ser m\xfaltiplo, separado por v\xedrgulas"}),"\n",(0,s.jsx)(o.p,{children:(0,s.jsx)(o.code,{children:"sonar.tests=tests"})}),"\n",(0,s.jsx)(o.p,{children:(0,s.jsx)(o.code,{children:"sonar.language"})}),"\n",(0,s.jsx)(o.p,{children:"Linguagem de programa\xe7\xe3o principal do projeto"}),"\n",(0,s.jsx)(o.p,{children:(0,s.jsx)(o.code,{children:"sonar.language=java"})}),"\n",(0,s.jsx)(o.p,{children:(0,s.jsx)(o.code,{children:"sonar.exclusions"})}),"\n",(0,s.jsx)(o.p,{children:"Arquivos ou diret\xf3rios a serem exclu\xeddos da an\xe1lise"}),"\n",(0,s.jsx)(o.p,{children:(0,s.jsx)(o.code,{children:"sonar.exclusions=**/*.xml"})}),"\n",(0,s.jsx)(o.p,{children:(0,s.jsx)(o.code,{children:"sonar.inclusions"})}),"\n",(0,s.jsx)(o.p,{children:"Especifica quais arquivos ou diret\xf3rios incluir na an\xe1lise, se for diferente dos padr\xf5es"}),"\n",(0,s.jsx)(o.p,{children:(0,s.jsx)(o.code,{children:"sonar.inclusions=src/**/*.java"})}),"\n",(0,s.jsx)(o.p,{children:(0,s.jsx)(o.code,{children:"sonar.tests.inclusions"})}),"\n",(0,s.jsx)(o.p,{children:"Especifica quais arquivos de teste incluir na an\xe1lise"}),"\n",(0,s.jsx)(o.p,{children:(0,s.jsx)(o.code,{children:"sonar.tests.inclusions=tests/**/*.java"})}),"\n",(0,s.jsx)(o.p,{children:(0,s.jsx)(o.code,{children:"sonar.test.exclusions"})}),"\n",(0,s.jsx)(o.p,{children:"Arquivos ou diret\xf3rios de teste a serem exclu\xeddos da an\xe1lise"}),"\n",(0,s.jsx)(o.p,{children:(0,s.jsx)(o.code,{children:"sonar.test.exclusions=tests/helpers/**"})}),"\n",(0,s.jsx)(o.p,{children:(0,s.jsx)(o.code,{children:"sonar.coverage.exclusions"})}),"\n",(0,s.jsx)(o.p,{children:"Arquivos ou diret\xf3rios a serem exclu\xeddos da an\xe1lise de cobertura de c\xf3digo"}),"\n",(0,s.jsx)(o.p,{children:(0,s.jsx)(o.code,{children:"sonar.coverage.exclusions=src/main/resources"})}),"\n",(0,s.jsx)(o.p,{children:"sonar.go.coverage.reportPaths"}),"\n",(0,s.jsx)(o.p,{children:"Caminho para o arquivo do relat\xf3rio de cobertura de testes para projetos em Golang"}),"\n",(0,s.jsx)(o.p,{children:(0,s.jsx)(o.code,{children:"sonar.go.coverage.reportPaths=reports/*coverage*.out"})}),"\n",(0,s.jsx)(o.p,{children:(0,s.jsx)(o.code,{children:"sonar.python.coverage.reportPaths"})}),"\n",(0,s.jsx)(o.p,{children:"Caminho para o arquivo do relat\xf3rio de cobertura de testes para projetos em Python"}),"\n",(0,s.jsx)(o.p,{children:(0,s.jsx)(o.code,{children:"sonar.python.coverage.reportPaths=reports/*coverage*.out"})}),"\n",(0,s.jsxs)(o.p,{children:["Mais comandos podem ser encontrados na ",(0,s.jsx)(o.a,{href:"https://docs.sonarsource.com/sonarqube/latest/analyzing-source-code/analysis-parameters/",children:"Documenta\xe7\xe3o do SonarCloud"})]}),"\n",(0,s.jsxs)(o.p,{children:["Exemplo de arquivo ",(0,s.jsx)(o.code,{children:"sonar-project.properties"})," comum"]}),"\n",(0,s.jsx)(o.pre,{children:(0,s.jsx)(o.code,{children:"sonar.projectKey=DigitalsysTecnologia_exemplo\nsonar.organization=digitalsys\n\nsonar.qualitygate.wait=true\n\nsonar.sources=.\nsonar.python.coverage.reportPaths=reports/coverage.xml\n\nsonar.coverage.exclusions=**/tests/**,Dockerfile\n"})}),"\n",(0,s.jsx)(o.h4,{id:"4-configurando-workflow-do-github-actions",children:(0,s.jsx)(o.strong,{children:"4. Configurando Workflow do GitHub Actions"})}),"\n",(0,s.jsxs)(o.ul,{children:["\n",(0,s.jsxs)(o.li,{children:["No reposit\xf3rio do projeto, crie um arquivo ",(0,s.jsx)(o.strong,{children:"\u201c.github/workflows/\u201d"})]}),"\n",(0,s.jsxs)(o.li,{children:["Dentro dessa pasta, crie um arquivo YAML, por exemplo, ",(0,s.jsx)(o.code,{children:"ci.yml"})]}),"\n",(0,s.jsx)(o.li,{children:"Nesse arquivo podemos definir a\xe7\xf5es que ser\xe3o executadas pelo GitHub em definidas mudan\xe7as no reposit\xf3rio"}),"\n"]}),"\n",(0,s.jsx)(o.p,{children:"Primeiro, podemos definir o nome do nosso workflow e quando ele ser\xe1 executado"}),"\n",(0,s.jsx)(o.pre,{children:(0,s.jsx)(o.code,{children:"name: Main Workflow\n\non:\n  push:\n    branches:\n      - '**'\n  pull_request:\n    types: [opened, synchronize, reopened]\n"})}),"\n",(0,s.jsxs)(o.p,{children:["Com esse c\xf3digo definimos um workflow chamado ",(0,s.jsxs)(o.strong,{children:["\u201c",(0,s.jsx)(o.strong,{children:"Main Workflow"}),"\u201d"]})," que ser\xe1 executado sempre que houver um push em qualquer branch do projeto e sempre que um pull request for aberto, sincronizado ou reaberto"]}),"\n",(0,s.jsx)(o.p,{children:"Agora podemos criar as a\xe7\xf5es que ser\xe3o executadas nos momentos definidos na primeira parte do c\xf3digo. Em nosso caso precisamos:"}),"\n",(0,s.jsxs)(o.ol,{children:["\n",(0,s.jsx)(o.li,{children:"Gerar o relat\xf3rio de cobertura de testes;"}),"\n",(0,s.jsx)(o.li,{children:"Enviar para an\xe1lise do SonarCloud;"}),"\n"]}),"\n",(0,s.jsx)(o.p,{children:"Para cada a\xe7\xe3o precisamos especificar os passos do zero, ent\xe3o para gerar o relat\xf3rio de testes precisamos iniciar o projeto como se estiv\xe9ssemos o executando pela primeira vez, o exemplo abaixo apresenta os passos necess\xe1rios para rodar um projeto em Python, d\xeas de configurar a vers\xe3o do Python que ser\xe1 utilizada at\xe9 o comando para se gerar o arquivo do relat\xf3rio pelo GitHub Actions"}),"\n",(0,s.jsx)(o.pre,{children:(0,s.jsx)(o.code,{children:"jobs:          \n  run-tests:\n    runs-on: ubuntu-latest\n\n    steps:\n      - uses: actions/checkout@v4\n\n      - name: Set up Python 3.12\n        uses: actions/setup-python@v5\n        with:\n          python-version: 3.12\n\n      - name: Install dependencies\n        run: |\n          python -m pip install --upgrade pip\n          pip install -r ./requirements.txt\n\n      - name: Run tests\n        run: |\n          pytest tests --cov=./ --cov-report=xml:reports/coverage.xml\n\n      - name: Store test reports\n        uses: actions/upload-artifact@v4\n        with:\n          name: coverage-report\n          path: ./reports/coverage.xml\n          retention-days: 1\n          if-no-files-found: error\n"})}),"\n",(0,s.jsxs)(o.p,{children:["Nesse c\xf3digo estamos criando um \u201cjob\u201d chamado ",(0,s.jsx)(o.code,{children:"run-tests"}),", nele come\xe7amos baixando uma vers\xe3o compat\xedvel com o projeto do Python e baixamos suas depend\xeancias. No exemplo foi gerado a cobertura de testes pelo pytest, utilizando a flag ",(0,s.jsx)(o.code,{children:"--cov-report=xml:reports/coverage.xml"}),", que est\xe1 armazenando o arquivo de relat\xf3rio em ",(0,s.jsx)(o.code,{children:"reports/coverage.xml"})]}),"\n",(0,s.jsx)(o.p,{children:"Por fim, utilizamos o \u201cactions/upload-artifact\u201d para armazenar o relat\xf3rio, o tornando acess\xedvel para os pr\xf3ximos jobs"}),"\n",(0,s.jsx)(o.p,{children:"Agora podemos criar um novo job, com o objetivo de enviar o relat\xf3rio gerado para a an\xe1lise do SonarCloud"}),"\n",(0,s.jsx)(o.pre,{children:(0,s.jsx)(o.code,{children:"sonar-scan:\n    needs: run-tests\n    runs-on: ubuntu-latest\n\n    steps:\n      - uses: actions/checkout@v4\n        with:\n          fetch-depth: 0\n\n      - name: Download coverage artifact\n        uses: actions/download-artifact@v4\n        with:\n          name: coverage-report\n          path: ./reports/\n\n      - name: SonarCloud Scan\n        uses: sonarsource/sonarcloud-github-action@master\n        env:\n          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}\n          SONAR_TOKEN: ${{ secrets.SONAR_TOKEN }}\n"})}),"\n",(0,s.jsxs)(o.p,{children:["\xc9 importante definir que esse job possui depend\xeancia no anterior (",(0,s.jsx)(o.code,{children:"needs: run-tests"}),"), pois se n\xe3o eles ir\xe3o ser executados em paralelo, por\xe9m precisamos esperar o artefato da primeira a\xe7\xe3o ser gerado"]}),"\n",(0,s.jsxs)(o.p,{children:["Com isso, podemos baixar o relat\xf3rio utilizando o \u201cactions/download-artifact\u201d e especificando o caminho de destino do arquivo. Nota: ",(0,s.jsx)(o.strong,{children:"O caminho de"})," ",(0,s.jsx)(o.strong,{children:"destino para o relat\xf3rio deve ser o mesmo especificado no"})," ",(0,s.jsx)(o.code,{children:"sonar-project.properties"})]}),"\n",(0,s.jsxs)(o.p,{children:["Por fim, podemos usar o m\xf3dulo do actions do sonarcloud \u201csonarsource/sonarcloud-github-action@master\u201d para realizar a an\xe1lise e enviar o relat\xf3rio automaticamente. \xc9 importante passar como vari\xe1vel o ",(0,s.jsx)(o.code,{children:"GITHUB_TOKEN"})," e o ",(0,s.jsx)(o.code,{children:"SONAR_TOKEN"}),", o Token do SonarCloud foi adicionado as secrets no passo 2., j\xe1 o Token do GitHub \xe9 setado automaticamente pelo pr\xf3prio GitHub nas secrets do reposit\xf3rio, para acessar uma secret pelo YAML de workflow do Actions basta utilizar ",(0,s.jsx)(o.code,{children:"${{ secrets.SECRET_NAME }}"})]}),"\n",(0,s.jsx)(o.p,{children:"Pronto, na pr\xf3xima vez que for feito um push ou um pull request as an\xe1lises de c\xf3digo e cobertura de testes deve estar presente no reposit\xf3rio do projeto no SonarCloud"}),"\n",(0,s.jsxs)(o.p,{children:["Exemplo completo do arquivo ",(0,s.jsx)(o.code,{children:"ci.yml"}),", para um projeto Python"]}),"\n",(0,s.jsx)(o.pre,{children:(0,s.jsx)(o.code,{children:"name: Main Workflow\n\non:\n  push:\n    branches:\n      - '**'\n  pull_request:\n    types: [opened, synchronize, reopened]\n\njobs:          \n  run-tests:\n    runs-on: ubuntu-latest\n\n    steps:\n      - uses: actions/checkout@v4\n\n      - name: Set up Python 3.12\n        uses: actions/setup-python@v5\n        with:\n          python-version: 3.12\n\n      - name: Install dependencies\n        run: |\n          python -m pip install --upgrade pip\n          pip install -r ./requirements.txt\n\n      - name: Run tests\n        run: |\n          pytest tests --cov=./ --cov-report=xml:reports/coverage.xml\n\n      - name: Store test reports\n        uses: actions/upload-artifact@v4\n        with:\n          name: coverage-report\n          path: ./reports/coverage.xml\n          retention-days: 1\n          if-no-files-found: error\n\n  sonar-scan:\n    needs: run-tests\n    runs-on: ubuntu-latest\n\n    steps:\n      - uses: actions/checkout@v4\n        with:\n          fetch-depth: 0\n\n      - name: Download coverage artifact\n        uses: actions/download-artifact@v4\n        with:\n          name: coverage-report\n          path: ./reports/\n\n      - name: SonarCloud Scan\n        uses: sonarsource/sonarcloud-github-action@master\n        env:\n          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}\n          SONAR_TOKEN: ${{ secrets.SONAR_TOKEN }}\n"})})]})}function p(e={}){const{wrapper:o}={...(0,a.R)(),...e.components};return o?(0,s.jsx)(o,{...e,children:(0,s.jsx)(l,{...e})}):l(e)}},8453(e,o,n){n.d(o,{R:()=>i,x:()=>d});var r=n(6540);const s={},a=r.createContext(s);function i(e){const o=r.useContext(a);return r.useMemo(function(){return"function"==typeof e?e(o):{...o,...e}},[o,e])}function d(e){let o;return o=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:i(e.components),r.createElement(a.Provider,{value:o},e.children)}}}]);
"use strict";(globalThis.webpackChunkmy_website=globalThis.webpackChunkmy_website||[]).push([[4581],{659(e,s,a){a.r(s),a.d(s,{assets:()=>d,contentTitle:()=>i,default:()=>u,frontMatter:()=>t,metadata:()=>o,toc:()=>c});const o=JSON.parse('{"id":"manual-do-dev/projetos/e-sus-urgencias/atualizar-ambiente-do-e-sus-datasus","title":"Atualizar ambiente do E-SUS (DataSUS)","description":"Garanta que voc\xea tenha os seguintes acessos:","source":"@site/docs/02-manual-do-dev/projetos/e-sus-urgencias/atualizar-ambiente-do-e-sus-datasus.md","sourceDirName":"02-manual-do-dev/projetos/e-sus-urgencias","slug":"/manual-do-dev/projetos/e-sus-urgencias/atualizar-ambiente-do-e-sus-datasus","permalink":"/docs-preview/docs/manual-do-dev/projetos/e-sus-urgencias/atualizar-ambiente-do-e-sus-datasus","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/02-manual-do-dev/projetos/e-sus-urgencias/atualizar-ambiente-do-e-sus-datasus.md","tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"Tela Recrutador","permalink":"/docs-preview/docs/manual-do-dev/projetos/dsrecruiter/tela-recrutador"},"next":{"title":"Banco de Dados","permalink":"/docs-preview/docs/manual-do-dev/projetos/e-sus-urgencias/banco-de-dados"}}');var r=a(4848),n=a(8453);const t={},i="Atualizar ambiente do E-SUS (DataSUS)",d={},c=[{value:"<strong>Garanta que voc\xea tenha os seguintes acessos:</strong>",id:"garanta-que-voc\xea-tenha-os-seguintes-acessos",level:4},{value:"<strong>Caso tenha Scripts SQLs novos</strong>",id:"caso-tenha-scripts-sqls-novos",level:3},{value:"<strong>Produ\xe7\xe3o</strong>",id:"produ\xe7\xe3o",level:3}];function l(e){const s={a:"a",code:"code",h1:"h1",h3:"h3",h4:"h4",header:"header",img:"img",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,n.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(s.header,{children:(0,r.jsx)(s.h1,{id:"atualizar-ambiente-do-e-sus-datasus",children:"Atualizar ambiente do E-SUS (DataSUS)"})}),"\n",(0,r.jsx)(s.h4,{id:"garanta-que-voc\xea-tenha-os-seguintes-acessos",children:(0,r.jsx)(s.strong,{children:"Garanta que voc\xea tenha os seguintes acessos:"})}),"\n",(0,r.jsxs)(s.ol,{children:["\n",(0,r.jsxs)(s.li,{children:["\n",(0,r.jsx)(s.p,{children:"VPN FortiClient"}),"\n"]}),"\n",(0,r.jsxs)(s.li,{children:["\n",(0,r.jsxs)(s.p,{children:["Acesso ao CITSmart: ",(0,r.jsx)(s.a,{href:"https://demandasdatasus.saude.gov.br/",children:"https://demandasdatasus.saude.gov.br/"})]}),"\n"]}),"\n",(0,r.jsxs)(s.li,{children:["\n",(0,r.jsxs)(s.p,{children:["Acesso ao Gitlab: ",(0,r.jsx)(s.a,{href:"https://gitlab.saude.gov.br/",children:"https://gitlab.saude.gov.br/"})]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:["\n",(0,r.jsxs)(s.p,{children:["Acesso ao reposit\xf3rio do Backend: ",(0,r.jsx)(s.a,{href:"https://gitlab.saude.gov.br/datasus/trauma/esus-urgencias/e-sus-urgencias-back/",children:"https://gitlab.saude.gov.br/datasus/trauma/esus-urgencias/e-sus-urgencias-back/"})]}),"\n"]}),"\n",(0,r.jsxs)(s.li,{children:["\n",(0,r.jsxs)(s.p,{children:["Acesso ao reposit\xf3rio do Frontend: ",(0,r.jsx)(s.a,{href:"https://gitlab.saude.gov.br/datasus/trauma/esus-urgencias/e-sus-urgencias-front",children:"https://gitlab.saude.gov.br/datasus/trauma/esus-urgencias/e-sus-urgencias-front"})]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(s.ol,{start:"4",children:["\n",(0,r.jsxs)(s.li,{children:["Acesso ao Rancher: ",(0,r.jsx)(s.a,{href:"https://console-prd.saude.gov.br/",children:"https://console-prd.saude.gov.br/"})]}),"\n"]}),"\n",(0,r.jsxs)(s.p,{children:["Em todo o processo voc\xea precisar\xe1 ",(0,r.jsx)(s.strong,{children:"obrigatoriamente"})," estar com a VPN ligada. ",(0,r.jsx)(s.strong,{children:"Lembrando que, para ligar a VPN FortiClient, primeiro voc\xea ter\xe1 que se desconectar da VPN Pritunl da empresa para evitar conflitos."})]}),"\n",(0,r.jsx)(s.p,{children:"Com isso em mente, os passos s\xe3o:"}),"\n",(0,r.jsx)(s.h3,{id:"caso-tenha-scripts-sqls-novos",children:(0,r.jsx)(s.strong,{children:"Caso tenha Scripts SQLs novos"})}),"\n",(0,r.jsxs)(s.p,{children:["Para realizar o deploy, v\xe1 ao Gitlab e clone o reposit\xf3rio (na branch ",(0,r.jsx)(s.strong,{children:"main"}),") do backend e do frontend. Note que nestes reposit\xf3rios j\xe1 existem alguns arquivos. ",(0,r.jsx)(s.strong,{children:"N\xc3O APAGUE ELES"}),". Eles s\xe3o necess\xe1rios para que voc\xea suba os ambientes corretamente."]}),"\n",(0,r.jsx)(s.p,{children:"Ap\xf3s clonar o reposit\xf3rio, para o backend copie todos os arquivos da pasta backend do reposit\xf3rio da DigitalSys no Github e cole. Lembre-se de retirar os arquivos que n\xe3o s\xe3o necess\xe1rios (exemplo: /dist, /node_modules, .env...)."}),"\n",(0,r.jsx)(s.p,{children:'Em seguida troque o nome da branch e realize o push para essa branch (atualmente o padr\xe3o de branch est\xe1 sendo "feat/sprint-<n\xfamero da sprint>"'}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-bash",children:'git checkout -b &lt;nome-da-branch>\ngit add .\ngit commit -m "&lt;descri\xe7\xe3o>"\ngit push\n'})}),"\n",(0,r.jsx)(s.p,{children:"Para executar os jobs de deploy voc\xea tamb\xe9m dever\xe1 fazer o push incluindo a tag de cada ambiente."}),"\n",(0,r.jsx)(s.p,{children:"As tags s\xe3o as seguintes:"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-markdown",children:"- Desenvolvimento: dev-&lt;hash do commit>\n- Staging: hom-&lt;hash do commit>\n- Treinamento: v.&lt;vers\xe3o>\n- Produ\xe7\xe3o: v.&lt;vers\xe3o>\n"})}),"\n",(0,r.jsx)(s.p,{children:"Exemplo de push para cada ambiente:"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-bash",children:'# Supondo que o hash do commit ap\xf3s o push \xe9 "123abc"\ngit tag dev-123abc \ngit push origin dev-123abc\n\ngit tag hom-123abc\ngit push origin hom-123abc\n\ngit tag v.1.0.0\ngit push origin v.1.0.0\n'})}),"\n",(0,r.jsx)(s.p,{children:'Pelo fato de Treinamento e Produ\xe7\xe3o utilizar o mesmo tagueamento, ao realizar o push considerando o padr\xe3o "v.<vers\xe3o>", voc\xea estar\xe1 subindo ambos os ambientes ao mesmo tempo.'}),"\n",(0,r.jsx)(s.p,{children:"Por fim, ao realizar esses push's voc\xea dever\xe1 ir at\xe9 o Gitlab e acompanhar o build. Caso o build complete sem erro voc\xea deve executar manualmente o deploy, conforme imagem abaixo:"}),"\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.a,{href:"https://ajuda.digitalsys.com.br/uploads/images/gallery/2025-10/scaled-1680-/CxKNNlUsG3azr6XI-captura-de-tela-2025-10-06-as-17-08-37.png",children:(0,r.jsx)(s.img,{src:"/docs-preview/img/atualizar-ambiente-do-e-sus-datasus-4.png",alt:"Captura de Tela 2025-10-06 a\u0300s 17.08.37.png"})})}),"\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.a,{href:"https://ajuda.digitalsys.com.br/uploads/images/gallery/2025-10/scaled-1680-/mikIO1pWZGFHiMwX-captura-de-tela-2025-10-06-as-17-09-09.png",children:(0,r.jsx)(s.img,{src:"/docs-preview/img/atualizar-ambiente-do-e-sus-datasus-5.png",alt:"Captura de Tela 2025-10-06 a\u0300s 17.09.09.png"})})}),"\n",(0,r.jsx)(s.p,{children:"Para acompanhar o processo de deploy, voc\xea dever\xe1 ir at\xe9 o Rancher e verificar o processo de deploy. Esse processo \xe9 acompanhado em Workloads > Pods"}),"\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.a,{href:"https://ajuda.digitalsys.com.br/uploads/images/gallery/2025-10/scaled-1680-/QW53IgLc9kegKjbN-captura-de-tela-2025-10-06-as-17-10-47.png",children:(0,r.jsx)(s.img,{src:"/docs-preview/img/atualizar-ambiente-do-e-sus-datasus-6.png",alt:"Captura de Tela 2025-10-06 a\u0300s 17.10.47.png"})})}),"\n",(0,r.jsx)(s.p,{children:'Caso d\xea qualquer tipo de problema o ideal \xe9 que voc\xea cheque os logs, clicando no s\xedmbolo de "tr\xeas pontinhos":'}),"\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.a,{href:"https://ajuda.digitalsys.com.br/uploads/images/gallery/2025-10/scaled-1680-/sS8t2DauybJAl3rT-captura-de-tela-2025-10-06-as-17-12-12.png",children:(0,r.jsx)(s.img,{src:"/docs-preview/img/atualizar-ambiente-do-e-sus-datasus-7.png",alt:"Captura de Tela 2025-10-06 a\u0300s 17.12.12.png"})})}),"\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.strong,{children:"O processo \xe9 o mesmo para o frontend (lembre-se de copiar apenas as pastas necess\xe1rias)."})}),"\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.strong,{children:"OBSERVA\xc7\xd5ES:"})}),"\n",(0,r.jsx)(s.p,{children:"- Caso d\xea qualquer tipo de problema referente a falta de espa\xe7o em disco voc\xea precisar\xe1 apagar imagens antigas do Container Registry, dentro do Gitlab."}),"\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.a,{href:"https://ajuda.digitalsys.com.br/uploads/images/gallery/2025-10/scaled-1680-/PmeIJGm4ybDsTIFP-captura-de-tela-2025-10-06-as-17-13-39.png",children:(0,r.jsx)(s.img,{src:"/docs-preview/img/atualizar-ambiente-do-e-sus-datasus-8.png",alt:"Captura de Tela 2025-10-06 a\u0300s 17.13.39.png"})})}),"\n",(0,r.jsxs)(s.p,{children:["- Se por qualquer outro motivo voc\xea encontrar algum erro fora do comum no processo de build, o contato de Infra \xe9 o ",(0,r.jsx)(s.a,{href:"mailto:victor.matos@saude.gov.br",children:"victor.matos@saude.gov.br"})," (Victor Ferreira de Matos)"]}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsx)(s.li,{children:'Se por ventura voc\xea precisar alterar alguma vari\xe1vel de ambiente, o mesmo deve ser feito no Rancher. As vari\xe1veis de ambiente do backend est\xe3o em "Secrets" e do frontend em "ConfigMaps".'}),"\n"]}),"\n",(0,r.jsx)(s.p,{children:"O frontend est\xe1 em ConfigMaps pois via Secrets n\xe3o foi poss\xedvel alterar as informa\xe7\xf5es sem a necessidade de rebuildar."}),"\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.a,{href:"https://ajuda.digitalsys.com.br/uploads/images/gallery/2025-10/scaled-1680-/l8Ogo8oQUFn3J9qR-captura-de-tela-2025-10-06-as-17-17-07.png",children:(0,r.jsx)(s.img,{src:"/docs-preview/img/atualizar-ambiente-do-e-sus-datasus-9.png",alt:"Captura de Tela 2025-10-06 a\u0300s 17.17.07.png"})})}),"\n",(0,r.jsx)(s.h3,{id:"produ\xe7\xe3o",children:(0,r.jsx)(s.strong,{children:"Produ\xe7\xe3o"})})]})}function u(e={}){const{wrapper:s}={...(0,n.R)(),...e.components};return s?(0,r.jsx)(s,{...e,children:(0,r.jsx)(l,{...e})}):l(e)}},8453(e,s,a){a.d(s,{R:()=>t,x:()=>i});var o=a(6540);const r={},n=o.createContext(r);function t(e){const s=o.useContext(n);return o.useMemo(function(){return"function"==typeof e?e(s):{...s,...e}},[s,e])}function i(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:t(e.components),o.createElement(n.Provider,{value:s},e.children)}}}]);